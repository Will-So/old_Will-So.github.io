<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
    <title>Analytical Sense | Quickly Make CLI Tools with Python</title>
    <link rel="shortcut icon" type="image/png" href="http://will-so.github.io/favicon.png">
    <link rel="shortcut icon" type="image/x-icon" href="http://will-so.github.io/favicon.ico">
    <link href="http://will-so.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Analytical Sense Full Atom Feed" />
    <link href="http://will-so.github.io/feeds/none.atom.xml" type="application/atom+xml" rel="alternate" title="Analytical Sense Categories Atom Feed" />
    <link rel="stylesheet" href="http://will-so.github.io/theme/css/screen.css" type="text/css" />
    <link rel="stylesheet" href="http://will-so.github.io/theme/css/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://will-so.github.io/theme/css/print.css" type="text/css" media="print" />
    <meta name="generator" content="Pelican" />

    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
    <!-- Added for the MathJax thing -->
    <script type="text/javascript">
    init_mathjax = function() {
        if (window.MathJax) {
            // MathJax loaded
            MathJax.Hub.Config({
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
                },
                displayAlign: 'left', // Change this to 'center' to center equations.
                "HTML-CSS": {
                    styles: {'.MathJax_Display': {"margin": 0}}
                }
            });
            MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
        }
    }
    init_mathjax();
    </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

    <script type="text/javascript">
    jQuery(document).ready(function($) {
        $("div.collapseheader").click(function () {
        $header = $(this).children("span").first();
        $codearea = $(this).children(".input_area");
        console.log($(this).children());
        $codearea.slideToggle(500, function () {
            $header.text(function () {
                return $codearea.is(":visible") ? "Collapse Code" : "Expand Code";
            });
        });
    });
    });
    </script>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-67989600-1', 'auto');
  ga('send', 'pageview');

</script>


    <meta name="keywords" content="Python,CLI" />
</head>
<body>
    <header>
        <nav>
            <ul>
                <li><a href="http://will-so.github.io">Home</a></li>
                <li><a href="http://will-so.github.io/pages/about.html">About</a></li>
                <li><a href="http://will-so.github.io/pages/data-projects.html">Data Projects</a></li>
                <li><a href="http://will-so.github.io/pages/glossary.html">Glossary</a></li>
                <li><a href="https://github.com/Will-So/">GitHub</a></li>
                <li><a href="http://will-so.github.io/tags">Tags</a></li>
                <li><a href="http://will-so.github.io/archives">Archives</a></li>
            </ul>
        </nav>
        <div class="header_box">
            <h1><a href="http://will-so.github.io">Analytical Sense</a></h1>
        </div>
    </header>
    <div id="wrapper">
        <div id="content">            <h4 class="date">Oct 21, 2015</h4>

            <article class="post">
                <h2 class="title">
                    <a href="http://will-so.github.io/blog/Quickly_Make_CLI_Tools_with_Python.html" rel="bookmark" title="Permanent Link to &quot;Quickly Make CLI Tools with Python&quot;">Quickly Make CLI Tools with Python</a>
                </h2>

                <p>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Synopsis">Synopsis<a class="anchor-link" href="#Synopsis">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If thinking of making a CLI tool, consider using Python with <code>click</code>. It is very fast and will make your life easier. It is probably the most straightforward way to automate tasks.</p>
<p>This script removes an enormous headache of making blog posts. As I already tend to take notes using the Jupyter Notebook, it makes it very easy to blog regularly.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Which-Library-to-Use">Which Library to Use<a class="anchor-link" href="#Which-Library-to-Use">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are a number of good libraries that make making CLI apps with Python easy. I am personally a big fan of <code>click</code> as it seems to be the quickest way to get running. I have a short CLI available that automates my blog posting workflow <a href="https://github.com/Will-So/pelican_autpost">here</a>.</p>
<p>Here is the heart of <code>pelican_autopost</code>. This little code already makes all of the necessary documentation, prompts, default values, and arguments.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="kn">import</span> <span class="nn">click</span>
<span class="n">BLOG_DIR</span> <span class="o">=</span> <span class="s">&#39;~/blog&#39;</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">command</span><span class="p">()</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s">&#39;--blog-dir&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">BLOG_DIR</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s">&#39;--notebook-path&#39;</span><span class="p">,</span> <span class="n">prompt</span><span class="o">=</span><span class="s">&#39;Enter the full notebook path&#39;</span><span class="p">,</span>
              <span class="n">help</span><span class="o">=</span><span class="s">&#39;files must be&#39;&#39;located in `blog_dir`&#39;</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s">&#39;--title&#39;</span><span class="p">,</span> <span class="n">prompt</span><span class="o">=</span><span class="s">&#39;enter the title. Must be unique&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="k">None</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s">&#39;--tags&#39;</span><span class="p">,</span> <span class="n">prompt</span><span class="o">=</span><span class="s">&#39;enter a tag. You may enter more than one via&#39;</span><span class="p">,</span>
              <span class="n">multiple</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s">&#39;--category&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="k">None</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_main</span><span class="p">(</span><span class="n">blog_dir</span><span class="p">,</span> <span class="n">notebook_path</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">category</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simple program that takes the directory of a notebook</span>
<span class="sd">     (use `greadlink -f file.ipynb |  pbcopy`)</span>
<span class="sd">    and other parameters and then publishes it to my pelican blog.</span>


<span class="sd">    Examples</span>
<span class="sd">    ----</span>
<span class="sd">    ./pelican_auto_post.py --tags *Nix --tags CLI  --title sqlite3</span>
<span class="sd">    Enter the full notebook path: /Users/Will/Devel/blog_posts/sqlite3_CLI.ipynb</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">notebook_path</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">make_md</span><span class="p">(</span><span class="n">blog_dir</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">category</span><span class="p">,</span> <span class="n">notebook_path</span><span class="p">)</span>
    <span class="n">copy_notebook</span><span class="p">(</span><span class="n">notebook_path</span><span class="p">,</span> <span class="n">blog_dir</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
    <span class="n">publish</span><span class="p">(</span><span class="n">blog_dir</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Running-the-Script-from-anywhere">Running the Script from anywhere<a class="anchor-link" href="#Running-the-Script-from-anywhere">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we have the script, we can easily run it from anywhere by performing the following steps:</p>
<ol>
<li>Make a directory for all of your CLI tools if you don't already have it. I use <code>~/scipts</code>. Move your script to here.</li>
<li>Add this directory to your <code>PATH</code> environmental variable. For OSX this is <code>~/.bash_profile</code> </li>
<li>Make sure you have the proper shebang line added to the top of your file <code>#!/usr/bin/env python3</code></li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Executing-Bash-Scripts">Executing Bash Scripts<a class="anchor-link" href="#Executing-Bash-Scripts">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Executing bash scripts from Python can be tricky. The <a href="https://github.com/Will-So/pelican_autpost">Github</a> describes how I did it but the most robust way to do this seems to be to execute the data directly from python like this:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="kn">from</span> <span class="nn">subprocess</span> <span class="k">import</span> <span class="n">call</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;~/scripts/script_name.sh&#39;</span><span class="p">):</span>
    <span class="n">script</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">rc</span> <span class="o">=</span> <span class="n">call</span><span class="p">(</span><span class="n">script</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Make sure that you only run this with trusted code that oyu are feeding it yourself. Otherwise it poses a security issue. An alterantive option would be to santize the file in Python before using <code>subprocess.call</code> on it.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Testing">Testing<a class="anchor-link" href="#Testing">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If the CLI is quite small, often times the best test is just going to be the script itself. I recommend to only test to prevent the things that can cause problems (accidently overwriting or deleting files). In the pelican autopost tool, for example, the only test I feel helped is the one that insures that the markdown files won't be overwritten because this could cause problems if there were to be two blog posts of the same title.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre> 
</pre></div>

</div>
</div>
</div>

</div></p>
                <div class="clear"></div>

                <div class="info">
                    <a href="http://will-so.github.io/blog/Quickly_Make_CLI_Tools_with_Python.html">posted at 00:00</a>
                    &nbsp;&middot;&nbsp;<a href="http://will-so.github.io/category/none.html" rel="tag">None</a>
                    &nbsp;&middot;
                    &nbsp;<a href="http://will-so.github.io/tags/python.html" class="tags">Python</a>
                    &nbsp;<a href="http://will-so.github.io/tags/cli.html" class="tags">CLI</a>
                </div>
            </article>
            <div class="clear"></div>
            <footer>
                <p>
                <a href="https://github.com/jody-frankowski/blue-penguin">Blue Penguin</a> Theme
                &middot;
                Powered by <a href="http://getpelican.com">Pelican</a>
                &middot;
                <a href="http://will-so.github.io/feeds/all.atom.xml" rel="alternate">Atom Feed</a>
            </footer>
        </div>
        <div class="clear"></div>
    </div>
</body>
</html>

