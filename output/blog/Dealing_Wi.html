<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
    <title>Analytical Sense | Dealing_With_Outliers:_The_Concepts</title>
    <link rel="shortcut icon" type="image/png" href="http://will-so.github.io/favicon.png">
    <link rel="shortcut icon" type="image/x-icon" href="http://will-so.github.io/favicon.ico">
    <link href="http://will-so.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Analytical Sense Full Atom Feed" />
    <link href="http://will-so.github.io/feeds/none.atom.xml" type="application/atom+xml" rel="alternate" title="Analytical Sense Categories Atom Feed" />
    <link rel="stylesheet" href="http://will-so.github.io/theme/css/screen.css" type="text/css" />
    <link rel="stylesheet" href="http://will-so.github.io/theme/css/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://will-so.github.io/theme/css/print.css" type="text/css" media="print" />
    <meta name="generator" content="Pelican" />

    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
    <!-- Added for the MathJax thing -->
    <script type="text/javascript">
    init_mathjax = function() {
        if (window.MathJax) {
            // MathJax loaded
            MathJax.Hub.Config({
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
                },
                displayAlign: 'left', // Change this to 'center' to center equations.
                "HTML-CSS": {
                    styles: {'.MathJax_Display': {"margin": 0}}
                }
            });
            MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
        }
    }
    init_mathjax();
    </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

    <script type="text/javascript">
    jQuery(document).ready(function($) {
        $("div.collapseheader").click(function () {
        $header = $(this).children("span").first();
        $codearea = $(this).children(".input_area");
        console.log($(this).children());
        $codearea.slideToggle(500, function () {
            $header.text(function () {
                return $codearea.is(":visible") ? "Collapse Code" : "Expand Code";
            });
        });
    });
    });
    </script>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-67989600-1', 'auto');
  ga('send', 'pageview');

</script>


    <meta name="keywords" content="ETL" />
</head>
<body>
    <header>
        <nav>
            <ul>
                <li><a href="http://will-so.github.io">Home</a></li>
                <li><a href="http://will-so.github.io/pages/about.html">About</a></li>
                <li><a href="http://will-so.github.io/pages/data-projects.html">Data Projects</a></li>
                <li><a href="http://will-so.github.io/pages/glossary.html">Glossary</a></li>
                <li><a href="https://github.com/Will-So/">GitHub</a></li>
                <li><a href="http://will-so.github.io/tags">Tags</a></li>
                <li><a href="http://will-so.github.io/archives">Archives</a></li>
            </ul>
        </nav>
        <div class="header_box">
            <h1><a href="http://will-so.github.io">Analytical Sense</a></h1>
        </div>
    </header>
    <div id="wrapper">
        <div id="content">            <h4 class="date">Jan 18, 2016</h4>

            <article class="post">
                <h2 class="title">
                    <a href="http://will-so.github.io/blog/Dealing_Wi.html" rel="bookmark" title="Permanent Link to &quot;Dealing_With_Outliers:_The_Concepts&quot;">Dealing_With_Outliers:_The_Concepts</a>
                </h2>

                <p>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Q:-What-are-some-ways-to-make-Models-Robust-to-Outliers">Q: What are some ways to make Models Robust to Outliers<a class="anchor-link" href="#Q:-What-are-some-ways-to-make-Models-Robust-to-Outliers">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Making-Robust-Models">Making Robust Models<a class="anchor-link" href="#Making-Robust-Models">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>One of the more difficult part of making predictive models is making sure that our model is robust to outliers. Fitting data strongly to outliers tends to give us bad predictive results. There are two solution that will work well in most cases and the are a few other methods worth considering when the first two either fail or are impracticle.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Use-a-robust-loss-function">Use a robust loss function<a class="anchor-link" href="#Use-a-robust-loss-function">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Mean squared error (MSE) and thus root mean squared error (RMSE) are very sensitive to outliers (<a href="#footnotes">1</a>). Sometimes, this is desirable where we want to punish an error of 20 much more than an error of 5. (400 vs 25). This is not desirable when we are trying to avoid undue</p>
<p>Mean Absolute Error is somewhat less sensitive to outliars because it does not square the errors. It is not "robust" to outliers but it represents a middle ground between traditional loss functions and methods discussed below.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-Huber-Loss-function">The Huber Loss function<a class="anchor-link" href="#The-Huber-Loss-function">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>One of the better loss functions to choose is the Huber Loss function. It is <a href="http://en.wikipedia.org/wiki/Huber_loss">defined</a> as:</p>
$$L_\delta (a) = \begin{cases}
 \frac{1}{2}{a^2}                   & \text{for } |a| \le \delta, \\
 \delta (|a| - \frac{1}{2}\delta), & \text{otherwise.}
\end{cases}$$<p>This has the effect of combining Squared Errors and Absolute Errors. For $|a| \le \delta$, the error function represents the RMSE. For $|a| \ge \delta$, the error function represents LAD.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Winsorizing-the-Data">Winsorizing the Data<a class="anchor-link" href="#Winsorizing-the-Data">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Winsorizing the data provides the same results as the Huber Loss Function when $\delta$ in the huber loss function is equal to the point at which the value is winsorized. This has a large disadvantage compared to the Huber Loss Function in that we are making changes to the dataset. That leaves us with a choice between making two copies of the data (one winsorized and non-winsorized) or discarding some information that may come in useful in future analysis. The former may not be practical for very large datasets.</p>
<p>An advantage of winsorizing data is that it makes it easy to visualize that data in a meaningful way.</p>
<p>Pandas has <code>pd.clip()</code> for this capability which makes it easy to use.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="http://upload.wikimedia.org/wikipedia/commons/c/c1/RhoFunctions.png" alt="">
Source: Wikipedia</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Discarding-Outliers">Discarding Outliers<a class="anchor-link" href="#Discarding-Outliers">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Most data munging has outliers that are almost certainly products of measurement errors or very rare anomalies.</p>
<p>Some examples of this:</p>
<ol>
<li>Demographic surveys where someone has 17 PhDs</li>
<li>Someone borrowing from lending club with a yearly income of 7M.</li>
<li>A stock transaction with a trade time before stock markets opened.</li>
</ol>
<p>Even in the event some of those observations were accurately measures (quite unlikely), they almost surely lack external validity so will only hurt the performance of our model unless we delete them.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Use-a-Model-that-is-Robust-to-Standard-Errors">Use a Model that is Robust to Standard Errors<a class="anchor-link" href="#Use-a-Model-that-is-Robust-to-Standard-Errors">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Support Vector Machines in particular tend to not consider outliers during training. Gradient Boosting, and Random Forests also have nice properties that make it difficult (but not impossible) to overfit a training dataset.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="A-Bad-method:-Log-transforms">A Bad method: Log transforms<a class="anchor-link" href="#A-Bad-method:-Log-transforms">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Log transforms are often mooted as a good way to make outliers stand out less. When we use a log transform we are allowing the outliers to dictate how we describe <strong>all of our observations</strong>. This is just the opposite of using a robust measure.</p>
<p>This is not to say that log transforms should not be used. There are many situations when log transforms should be used <strong>due to the behavior of all the observations</strong>:</p>
<ol>
<li>When the errors have an extreme positvely skewed distribution. We then use the <a href="http://en.wikipedia.org/wiki/Power_transform#Box.E2.80.93Cox_transformation">Box-Cox</a>. This allows us to improve the validity of the Pearson Correlation coefficient, stabalize variance, and in general make traditional descriptive statistics more meaningful.</li>
<li>When the relationship being investigates is close to exponential.</li>
<li>When you want to represent a model that explains the explanatory variables' influence in terms of percentages (relative values) rather than absolute differences. </li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="-Footnotes"><a id="footnotes" /> Footnotes<a class="anchor-link" href="#-Footnotes">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>[1]: This is easy to see from the mathematical definition of MSE: $1/n \sum( \hat Y_i- Y_i)^2$. Since the distance between the sample mean and the datapoint is squared, it exaggerates the influence of outliers.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="References">References<a class="anchor-link" href="#References">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><a href="http://stats.stackexchange.com/questions/48267/mean-absolute-error-or-root-mean-squared-error">http://stats.stackexchange.com/questions/48267/mean-absolute-error-or-root-mean-squared-error</a></li>
<li><a href="http://projecteuclid.org/download/pdf_1/euclid.aoms/1177703732">http://projecteuclid.org/download/pdf_1/euclid.aoms/1177703732</a></li>
</ul>

</div>
</div>
</div></p>
                <div class="clear"></div>

                <div class="info">
                    <a href="http://will-so.github.io/blog/Dealing_Wi.html">posted at 00:00</a>
                    &nbsp;&middot;&nbsp;<a href="http://will-so.github.io/category/none.html" rel="tag">None</a>
                    &nbsp;&middot;
                    &nbsp;<a href="http://will-so.github.io/tags/etl.html" class="tags">ETL</a>
                </div>
            </article>
            <div class="clear"></div>
            <footer>
                <p>
                <a href="https://github.com/jody-frankowski/blue-penguin">Blue Penguin</a> Theme
                &middot;
                Powered by <a href="http://getpelican.com">Pelican</a>
                &middot;
                <a href="http://will-so.github.io/feeds/all.atom.xml" rel="alternate">Atom Feed</a>
            </footer>
        </div>
        <div class="clear"></div>
    </div>
</body>
</html>

