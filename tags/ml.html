<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Analytical Sense | articles tagged "ML"</title>
    <link rel="shortcut icon" type="image/png" href="http://will-so.github.io/favicon.png">
    <link rel="shortcut icon" type="image/x-icon" href="http://will-so.github.io/favicon.ico">
    <link href="http://will-so.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Analytical Sense Full Atom Feed" />
    <link rel="stylesheet" href="http://will-so.github.io/theme/css/screen.css" type="text/css" />
    <link rel="stylesheet" href="http://will-so.github.io/theme/css/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://will-so.github.io/theme/css/print.css" type="text/css" media="print" />
    <meta name="generator" content="Pelican" />

    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
    <!-- Added for the MathJax thing -->
    <script type="text/javascript">
    init_mathjax = function() {
        if (window.MathJax) {
            // MathJax loaded
            MathJax.Hub.Config({
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
                },
                displayAlign: 'left', // Change this to 'center' to center equations.
                "HTML-CSS": {
                    styles: {'.MathJax_Display': {"margin": 0}}
                }
            });
            MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
        }
    }
    init_mathjax();
    </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

    <script type="text/javascript">
    jQuery(document).ready(function($) {
        $("div.collapseheader").click(function () {
        $header = $(this).children("span").first();
        $codearea = $(this).children(".input_area");
        console.log($(this).children());
        $codearea.slideToggle(500, function () {
            $header.text(function () {
                return $codearea.is(":visible") ? "Collapse Code" : "Expand Code";
            });
        });
    });
    });
    </script>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-67989600-1', 'auto');
  ga('send', 'pageview');

</script>

</head>
<body>
    <header>
        <nav>
            <ul>
                <li class="ephemeral selected"><a href="http://will-so.github.io/tags/ml.html">ML</a></li>
                <li><a href="http://will-so.github.io">Home</a></li>
                <li><a href="http://will-so.github.io/pages/about.html">About</a></li>
                <li><a href="http://will-so.github.io/pages/data-projects.html">Data Projects</a></li>
                <li><a href="http://will-so.github.io/pages/glossary.html">Glossary</a></li>
                <li><a href="https://github.com/Will-So/">GitHub</a></li>
                <li><a href="http://will-so.github.io/tags">Tags</a></li>
                <li><a href="http://will-so.github.io/archives">Archives</a></li>
            </ul>
        </nav>
        <div class="header_box">
            <h1><a href="http://will-so.github.io">Analytical Sense</a></h1>
        </div>
    </header>
    <div id="wrapper">
        <div id="content">            <h4 class="date">Dec 16, 2015</h4>

            <article class="post">
                <h2 class="title">
                    <a href="http://will-so.github.io/blog/Starting_a.html" rel="bookmark" title="Permanent Link to &quot;Starting a Successful Restaurant&quot;">Starting a Successful Restaurant</a>
                </h2>

                <p>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Founding a successful restaurant is hard. 60% fail in 3 years. This pales in comparison to hotel chains that average a 7% failure rate over 10 years. Growing up, my uncle Jim struggled with his restaurant for 3 years before he finally admitted defeat.</p>
<p>Can we use Data to improve the chances of starting a successful restaurant? This month, I decided to find out.</p>
<p>The goal for this project is:</p>
<ol>
<li>Find the location that maximizes their chances for success</li>
<li>Choose the ameneties and other features that maximize their chance of success </li>
<li>Predict their chances of success given their prospective location and amenities. </li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="1.-Getting-the-Data">1. Getting the Data<a class="anchor-link" href="#1.-Getting-the-Data">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Thanks to the Yelp Challenge, the data I needed was easy to get and the data was shockingly consistent. There were next to no anomalous data points.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="2.-Defining-Success">2. Defining Success<a class="anchor-link" href="#2.-Defining-Success">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>One challenge of this project is defining success. I don't have the profits and losses of individual restaurants so I need to infer success based on observable data we have. I define the function as $F(Rating, \frac{Number\_Reviews}{Month}, Time)$. The actual form of this function is somewhat complicated and can be seen in the <code>measuring_success</code> notebook. The top 25% of Yelp Restaurants according to this function were labeled as successful.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="3.-Feature-Engineering">3. Feature Engineering<a class="anchor-link" href="#3.-Feature-Engineering">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Location-Location-Location">Location Location Location<a class="anchor-link" href="#Location-Location-Location">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>One of the key features in my model is the success of businesses in a nearby location. I use a K-d tree to efficiently find the 10 nearest businesses to a given point and then average those success values.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Latent-Topics">Latent Topics<a class="anchor-link" href="#Latent-Topics">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I use latent topics with Latent Dirichlet allocation to make features. This combination of using an unsupervised learning technique to generate features for a supervised model can provide powerful insights.</p>
<p>Unfortunately, latent topics in this case were simply not predictive of success. This is despite coherent categories.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Explicit-Topics">Explicit Topics<a class="anchor-link" href="#Explicit-Topics">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Explicit topics (i.e., categories) perform much better than LDA topics. They end up predicting nearly as well as location in the aggregate.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="4.-Modeling,-Evaluating,-and-Refining">4. Modeling, Evaluating, and Refining<a class="anchor-link" href="#4.-Modeling,-Evaluating,-and-Refining">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I tried a number of different classifiers at first. Random Forests performed the best but there was still something wrong with it. It had way too many false positives. If my model predicted that the restaurant would be successful, the restaurant would only actually be successful 50% of the time. This is much better than change (25%) but I thought we can do better.</p>
<p>I adjusted the classifer to have balanced classes in each tree and this decreased the false positive substantially. Now my model had a true positive rate of 66%. This represents more than a 150% increase in the chanse of being successful.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://dl.dropboxusercontent.com/u/97258109/Screens/S3668.png" alt=""></p>
<p>The most important features:</p>
<p><img src="https://dl.dropboxusercontent.com/u/97258109/Screens/S3669.png" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="5.-Building-the-Web-App">5. Building the Web App<a class="anchor-link" href="#5.-Building-the-Web-App">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since most people who want to start restaurants tend not to be very technically savy, I decided to build a web app that allows people to easily use the model I built. Building the app was extremely straightfoward thanks to the awesomeness of Flask.</p>
<p>This is a screenshot of the app I built:</p>
<p><img src="https://dl.dropboxusercontent.com/u/97258109/Screens/S3665.png" alt=""></p>
<p>The user workflow is:</p>
<ol>
<li>User picks city. Map pans to city.</li>
<li>User Picks the type of restaurant</li>
<li>User clicks on the map to specify a location</li>
<li>App returns probability of success. </li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Conclusion">Conclusion<a class="anchor-link" href="#Conclusion">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using data to inform our decisions when founding a new business can be extremely valuable.</p>
<p>This project also shows how valuable a good frontend can be for communicating insights in data. Without a good interface it would be difficult for people to make use of this data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Threats-to-Model-Validity">Threats to Model Validity<a class="anchor-link" href="#Threats-to-Model-Validity">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Maturation: The test dataset that we evaluated accuracy on only has currently existing companies. It could be the case that past patterns of success are no longer predictive. </li>
<li>Saturation: My model does not consider the potential of saturation. If we have too many sushi places right next to eachother, this can cause problems for profitability. Businesses being close to eachother is a good strategy to a point</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="The-Next-Iteration">The Next Iteration<a class="anchor-link" href="#The-Next-Iteration">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ol>
<li>Add a heat map</li>
<li>The app is currently not hosted anywhere. I hope to deploy it in the near future so others can make use of it.</li>
<li>Add NLP features based on the reviews of the restaurant. </li>
<li>Generalize to other businesses.</li>
</ol>

</div>
</div>
</div></p>
                <div class="clear"></div>

                <div class="info">
                    <a href="http://will-so.github.io/blog/Starting_a.html">posted at 00:00</a>
                    &nbsp;&middot;&nbsp;<a href="http://will-so.github.io/category/none.html" rel="tag">None</a>
                    &nbsp;&middot;
                    &nbsp;<a href="http://will-so.github.io/tags/ds.html" class="tags">DS</a>
                    &nbsp;<a href="http://will-so.github.io/tags/ml.html" class="tags selected">ML</a>
                </div>
            </article>            <h4 class="date">Nov 16, 2015</h4>

            <article class="post">
                <h2 class="title">
                    <a href="http://will-so.github.io/blog/Everything.html" rel="bookmark" title="Permanent Link to &quot;Everything You Need to Know to Use Random Forests&quot;">Everything You Need to Know to Use Random Forests</a>
                </h2>

                <p>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Random Forests are an increasingly popular machine learning algorithim. They perform well in a wide variety of learning and prediction problems despite being exceedingly easy to implement. Random forests can be used for both classification and regression problems.</p>
<p>This post describes the intuition of how Random Forests work as well as its. advantages and disadvantages.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Intuition-for-How-Random-Forests-Work">Intuition for How Random Forests Work<a class="anchor-link" href="#Intuition-for-How-Random-Forests-Work">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>At a high level, the algorithim usually works as follows:</p>
<ol>
<li>Randomly sample $N$ observations from the training set at random with replacement [1]</li>
<li>Train a decision tree using $N$ and $\sqrt{num\_features}$.</li>
</ol>
<p>Repeat (1) and (2) B times, where B is the number of trees (also called bags). Depending on the nature of data, the ideal number of trees ranging from 100 to several thousand.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="http://image.slidesharecdn.com/janvitekdistributedrandomforest5-2-2013-130504133205-phpapp02/95/jan-vitek-distributedrandomforest522013-8-638.jpg?cb=1367674437" alt="">
<a href="http://www.slideshare.net/0xdata/jan-vitek-distributedrandomforest522013">Source: Jan Vitek, Perdue</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Main-Advantages">Main Advantages<a class="anchor-link" href="#Main-Advantages">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Embarrassingly-Parallel">Embarrassingly Parallel<a class="anchor-link" href="#Embarrassingly-Parallel">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>SKlearn will allow you to use all the cores in your computer to train multiple trees at the same time. The algorithim is also available in Spark. This is because all random forests are trained independently of eachother.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Resistant-to-Overfitting">Resistant to Overfitting<a class="anchor-link" href="#Resistant-to-Overfitting">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The only way to overfit the model is to have trees that have too many branches. Increasing the number of trees does not increase the risk of overfitting. Instead an increasing number of trees tends to decrease the amount of overfitting</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="No-Need-for-Cross-Validation">No Need for Cross Validation<a class="anchor-link" href="#No-Need-for-Cross-Validation">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also avoid cross-validation by using the <em>out of bag score</em>. This is available as an argument in Spark and Sklearn and provides nearly identical results to N-fold cross-validation.[2]</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Other-Advantages">Other Advantages<a class="anchor-link" href="#Other-Advantages">&#182;</a></h2><ul>
<li>Most implementations make it trivial to find feature importance</li>
<li>It is very easy to Tune</li>
<li>Random Forests excel with highly non-linear relationships in the data.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Main-Disadvantages">Main Disadvantages<a class="anchor-link" href="#Main-Disadvantages">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Can-perform-worse-than-Gradient-Boost">Can perform worse than Gradient Boost<a class="anchor-link" href="#Can-perform-worse-than-Gradient-Boost">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Gradient Boosted Machines tend to perform better under both of the following conditions:</p>
<ol>
<li>We correctly tune the relatively complicated hyperparamters of GBM. </li>
<li>Either 1) your data fits in ram (for sklearn) or 2) your problem is not a multiclass classification problem (for Spark).</li>
<li>(My understanding, not certain) Non-linear relationships </li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Slow-to-Predict">Slow to Predict<a class="anchor-link" href="#Slow-to-Predict">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since predicting a new observation requires running the observation through every tree, Random Forests will often perform too poorly for real-time prediction.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Doesn't-behave-well-for-very-sparse-feature-sets">Doesn't behave well for very sparse feature sets<a class="anchor-link" href="#Doesn't-behave-well-for-very-sparse-feature-sets">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this case, SVM and Naive Bayes tend to perform better than Random Forests. One of the reasons for this is because each tree only has access to $\sqrt{n}$ features by default. If very few features are of any importance, most trees will miss important features.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Using-it-in-sklearn">Using it in sklearn<a class="anchor-link" href="#Using-it-in-sklearn">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Below is an example of using a Random Forest with 50 trees:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">model_rf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="k">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                  <span class="n">random_state</span><span class="o">=</span><span class="mi">2143</span><span class="p">,</span> <span class="n">min_samples_split</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> 
                                 <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fitted_model</span> <span class="o">=</span> <span class="n">model_rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>oob_score</code> argument tells the classifier to return our out of sample (bag) error estimates. The <code>min_samples_split=50</code> argument tells the classifer to only create another branch of the tree if the current branch has more than 50 observations. <code>n_jobs=-1</code> tells SKlearn to use all the cores on my machine.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Using-it-in-Spark">Using it in Spark<a class="anchor-link" href="#Using-it-in-Spark">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>An example of using Random Forests in Spark can be found <a href="https://spark.apache.org/docs/latest/mllib-ensembles.html">here</a>. Here is the same example as in SKlearn:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Practical-tips">Practical tips<a class="anchor-link" href="#Practical-tips">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>A good way to prevent overfitting is to set a relatively high tree-splitting threshhold. This is the <code>min_samples_split</code> argument in SKLearn. </li>
<li>We can easily check if we are overfitting by looking at the out of bag error. </li>
<li>More trees are always better than fewer. The returns start to dominish quickly. 
  <img src="https://dl.dropboxusercontent.com/u/97258109/Screens/S3580.png" width="300"/><ul>
<li>Source <a href="http://www.isip.piconepress.com/projects/dpm_inference/html/performance.html">here</a></li>
</ul>
</li>
<li>Having trees that are too deep can lead to overfitting. This can be avoided by increasing the number of trees. </li>
<li>The default number of features ($\sqrt{n}$) is usually a sufficiently good value. </li>
<li>After picking the best Random Forest with your out of bag errors, </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Footnotes">Footnotes<a class="anchor-link" href="#Footnotes">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>[1]: This means that the sample size will be the same as the training set size but the composition of the sample will be different because it is being sampled with replacement.</p>
<p>[2]: This works by looking at the errors of the trees where the relevant observation $(X_i, y_i)$ did not occur.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="References">References<a class="anchor-link" href="#References">&#182;</a></h1><ol>
<li>Friedman, Jerome, Trevor Hastie, and Robert Tibshirani. The elements of statistical learning. Vol. 1. Springer, Berlin: Springer series in statistics, 2001.
APA    </li>
<li><a href="http://www.slideshare.net/0xdata/jan-vitek-distributedrandomforest522013">http://www.slideshare.net/0xdata/jan-vitek-distributedrandomforest522013</a></li>
<li><a href="http://scikit-learn.org/stable/modules/ensemble.html">http://scikit-learn.org/stable/modules/ensemble.html</a></li>
<li><a href="http://download.springer.com/static/pdf/639/art%253A10.1023%252FA%253A1010933404324.pdf?originUrl=http%3A%2F%2Flink.springer.com%2Farticle%2F10.1023%2FA%3A1010933404324&token2=exp=1447688130~acl=%2Fstatic%2Fpdf%2F639%2Fart%25253A10.1023%25252FA%25253A1010933404324.pdf%3ForiginUrl%3Dhttp%253A%252F%252Flink.springer.com%252Farticle%252F10.1023%252FA%253A1010933404324*~hmac=3b7a5a59b9ee6c2c4c500ef943cd2e0725e74621ba10977e4b51c8989b1819c7">Random Forests by Leo Breiman</a></li>
</ol>

</div>
</div>
</div></p>
                <div class="clear"></div>

                <div class="info">
                    <a href="http://will-so.github.io/blog/Everything.html">posted at 00:00</a>
                    &nbsp;&middot;&nbsp;<a href="http://will-so.github.io/category/none.html" rel="tag">None</a>
                    &nbsp;&middot;
                    &nbsp;<a href="http://will-so.github.io/tags/ml.html" class="tags selected">ML</a>
                </div>
            </article>

            <div class="clear"></div>
            <footer>
                <p>
                <a href="https://github.com/jody-frankowski/blue-penguin">Blue Penguin</a> Theme
                &middot;
                Powered by <a href="http://getpelican.com">Pelican</a>
                &middot;
                <a href="http://will-so.github.io/feeds/all.atom.xml" rel="alternate">Atom Feed</a>
            </footer>
        </div>
        <div class="clear"></div>
    </div>
</body>
</html>

